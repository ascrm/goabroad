让我先了解一下当前发布帖子的实现情况，然后为您生成优化的AI提示词。

[3 tools called]

好的！我已经了解了当前的发帖流程实现。现在为您生成优化后的AI提示词：

---

# 🎯 AI开发提示词：简化发帖流程 - Twitter/X风格

## 📋 任务概述

**目标**：将当前的多步骤发帖流程简化为类似Twitter/X的即时发布体验

**核心改进**：
- ✅ 移除内容类型选择步骤（发帖/提问/视频）
- ✅ 打开即可直接输入内容
- ✅ 简化必填项，提升发布效率
- ✅ 保持图片/视频上传等核心功能

---

## 📁 需要修改的文件

**主文件**：
- `app/community/create.jsx` - 发布帖子页面（需重构）

**组件文件**（可选优化）：
- `src/components/community/create/CategoryPicker.jsx` - 改为可选
- `src/components/community/create/TagInput.jsx` - 保持
- `src/components/community/create/MediaPicker.jsx` - 保持

---

## 🎨 新UI/UX设计要求

### 页面布局（类似Twitter）

```
┌─────────────────────────────────┐
│  ✕                         发布  │  ← Header
├─────────────────────────────────┤
│  👤  ┌─────────────────────┐    │
│      │ 有什么新鲜事？       │    │  ← 文本输入区
│      │                     │    │    （多行，自动扩展）
│      │                     │    │
│      └─────────────────────┘    │
│                                 │
│  [图片预览区域]                  │  ← 如果有上传图片
│                                 │
│  ────────────────────────────  │
│  📷  🎬  #  😊  📍  🎯          │  ← 工具栏
│                                 │
│  [分区: 美国]  [标签: #留学]     │  ← 可选信息（折叠）
└─────────────────────────────────┘
```

### 关键改进点

1. **直接输入**
   - 页面加载后，光标自动聚焦到输入框
   - 无需先选择类型，默认就是"普通帖子"类型
   - 占位符：`"有什么新鲜事？"` 或 `"分享你的出国经验..."`

2. **简化标题**
   - **移除强制标题**（Twitter也没有标题）
   - 如果需要标题，让用户在正文第一行输入即可
   - 或完全取消标题字段

3. **分区选择改为可选**
   - 不再强制选择分区
   - 提供快捷分区按钮（如：美国、英国、签证、申请等）
   - 未选择分区时自动归入"综合讨论"

4. **底部工具栏**
   - 简洁的图标按钮
   - 📷 图片（点击上传）
   - 🎬 视频（点击上传）
   - # 添加标签
   - 😊 表情符号（可选）
   - 📍 位置（可选）
   - 🎯 分区（可选）

5. **发布按钮智能激活**
   - 最低要求：内容至少10个字符
   - 不再强制要求分区、类型等
   - 按钮状态：禁用（灰色）→ 可用（蓝色）

---

## 💻 代码实现要求

### 1. 移除类型选择逻辑

**现有代码问题**：
```javascript
// 当前实现 - 需要先选择类型
const [postType, setPostType] = useState(null);

{!postType && (
  <View style={styles.typeSelector}>
    {POST_TYPES.map((type) => (...))}  // 类型选择界面
  </View>
)}
```

**优化后代码**：
```javascript
// 新实现 - 默认就是普通帖子
const [postType] = useState('post'); // 固定为post类型，不再显示选择器

// 完全移除类型选择UI
// 直接显示编辑器
```

### 2. 简化表单验证

**现有验证规则**：
```javascript
const validateForm = () => {
  if (!postType) return false;           // ❌ 移除
  if (postType === 'question' && !title.trim()) return false;  // ❌ 移除
  if (!content.trim()) return false;     // ✅ 保留
  if (content.trim().length < 10) return false;  // ✅ 保留
  if (!category) return false;           // ❌ 改为可选
  return true;
};
```

**新验证规则**：
```javascript
const validateForm = () => {
  // 仅检查内容
  if (!content.trim()) {
    Toast.show('请输入内容');
    return false;
  }
  if (content.trim().length < 10) {
    Toast.show('内容至少需要10个字符');
    return false;
  }
  return true;
};
```

### 3. 重构页面结构

**新的组件结构**：
```jsx
export default function CreatePost() {
  const router = useRouter();
  const contentInputRef = useRef(null);
  
  // 状态管理 - 简化
  const [content, setContent] = useState('');
  const [images, setImages] = useState([]);
  const [video, setVideo] = useState(null);
  const [category, setCategory] = useState(null);  // 可选
  const [tags, setTags] = useState([]);            // 可选
  const [showToolbar, setShowToolbar] = useState(true);
  const [isPublishing, setIsPublishing] = useState(false);

  // 自动聚焦
  useEffect(() => {
    setTimeout(() => {
      contentInputRef.current?.focus();
    }, 300);
  }, []);

  // 智能发布按钮
  const canPublish = () => {
    return !isPublishing && 
           content.trim().length >= 10;
  };

  return (
    <SafeAreaView style={styles.container}>
      {/* Header */}
      <View style={styles.header}>
        <TouchableOpacity onPress={handleCancel}>
          <Ionicons name="close" size={24} />
        </TouchableOpacity>
        
        <TouchableOpacity 
          style={[styles.publishBtn, !canPublish() && styles.disabled]}
          onPress={handlePublish}
          disabled={!canPublish()}
        >
          <Text style={styles.publishText}>发布</Text>
        </TouchableOpacity>
      </View>

      {/* 主输入区 */}
      <ScrollView style={styles.content}>
        <View style={styles.inputContainer}>
          {/* 用户头像 */}
          <Avatar size={40} source={currentUser.avatar} />
          
          {/* 文本输入 */}
          <TextInput
            ref={contentInputRef}
            style={styles.contentInput}
            placeholder="有什么新鲜事？"
            placeholderTextColor={COLORS.gray[400]}
            value={content}
            onChangeText={setContent}
            multiline
            maxLength={3000}
            autoFocus
          />
        </View>

        {/* 图片/视频预览 */}
        {images.length > 0 && (
          <MediaPreview images={images} onRemove={removeImage} />
        )}
        {video && (
          <VideoPreview video={video} onRemove={() => setVideo(null)} />
        )}

        {/* 已选信息标签（折叠显示） */}
        {(category || tags.length > 0) && (
          <View style={styles.selectedInfo}>
            {category && <Chip text={category} onRemove={() => setCategory(null)} />}
            {tags.map(tag => (
              <Chip key={tag} text={`#${tag}`} onRemove={() => removeTag(tag)} />
            ))}
          </View>
        )}
      </ScrollView>

      {/* 底部工具栏 */}
      <View style={styles.toolbar}>
        <TouchableOpacity onPress={pickImages}>
          <Ionicons name="image-outline" size={24} color={COLORS.primary[600]} />
        </TouchableOpacity>
        
        <TouchableOpacity onPress={pickVideo}>
          <Ionicons name="videocam-outline" size={24} color={COLORS.primary[600]} />
        </TouchableOpacity>
        
        <TouchableOpacity onPress={() => setShowTagInput(true)}>
          <Ionicons name="pricetag-outline" size={24} color={COLORS.primary[600]} />
        </TouchableOpacity>
        
        <TouchableOpacity onPress={() => setShowCategoryPicker(true)}>
          <Ionicons name="grid-outline" size={24} color={COLORS.primary[600]} />
        </TouchableOpacity>

        <View style={styles.charCount}>
          <Text style={styles.charCountText}>
            {content.length}/3000
          </Text>
        </View>
      </View>
    </SafeAreaView>
  );
}
```

### 4. 发布逻辑优化

```javascript
const handlePublish = async () => {
  if (!validateForm()) return;

  setIsPublishing(true);

  try {
    const postData = {
      type: 'post',                    // 固定类型
      content: content.trim(),
      images: images.map(img => img.url),  // 已上传的URL
      video: video?.url || null,
      category: category || '综合讨论',  // 未选择时默认值
      tags: tags,
      allowComments: true,              // 默认允许
      onlyFollowers: false,             // 默认公开
    };

    // 调用API
    const result = await dispatch(createPost(postData)).unwrap();
    
    // 成功反馈
    Toast.show('发布成功！');
    
    // 跳转到帖子详情或返回社区
    router.push(`/community/post/${result.id}`);
    
  } catch (error) {
    Toast.show('发布失败，请重试');
  } finally {
    setIsPublishing(false);
  }
};
```

---

## 🎯 具体优化点清单

### 必须完成（P0）

- [ ] **移除类型选择器UI**（第308-329行的typeSelector）
- [ ] **设置默认类型为'post'**（第41行）
- [ ] **移除标题输入框**（第360-377行，或改为可选）
- [ ] **修改表单验证**（第150-177行）
- [ ] **分区改为可选**（不再Alert提示必填）
- [ ] **添加自动聚焦**（useEffect自动focus输入框）
- [ ] **重新设计工具栏**（底部工具栏代替当前的optionRow）

### 推荐完成（P1）

- [ ] **添加字符计数器**（显示在工具栏右侧）
- [ ] **图片/视频预览优化**（缩略图式预览）
- [ ] **快捷分区按钮**（常用分区快速选择）
- [ ] **草稿自动保存**（保持现有功能）
- [ ] **发布成功后跳转**（跳转到帖子详情页）

### 可选优化（P2）

- [ ] **表情选择器**（添加emoji picker）
- [ ] **@提及用户**（输入@触发用户搜索）
- [ ] **话题联想**（输入#触发话题推荐）
- [ ] **位置标记**（可选添加地理位置）

---

## 📝 样式参考

```javascript
const styles = StyleSheet.create({
  container: {
    flex: 1,
    backgroundColor: COLORS.white,
  },
  header: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
    paddingHorizontal: 16,
    paddingVertical: 12,
    borderBottomWidth: 1,
    borderBottomColor: COLORS.gray[200],
  },
  publishBtn: {
    paddingHorizontal: 20,
    paddingVertical: 8,
    backgroundColor: COLORS.primary[600],
    borderRadius: 20,
  },
  disabled: {
    backgroundColor: COLORS.gray[300],
    opacity: 0.6,
  },
  publishText: {
    fontSize: 15,
    fontWeight: '600',
    color: COLORS.white,
  },
  content: {
    flex: 1,
  },
  inputContainer: {
    flexDirection: 'row',
    padding: 16,
    alignItems: 'flex-start',
  },
  contentInput: {
    flex: 1,
    marginLeft: 12,
    fontSize: 16,
    color: COLORS.gray[900],
    minHeight: 100,
    maxHeight: 400,
  },
  toolbar: {
    flexDirection: 'row',
    alignItems: 'center',
    paddingHorizontal: 16,
    paddingVertical: 12,
    borderTopWidth: 1,
    borderTopColor: COLORS.gray[200],
    gap: 20,
  },
  charCount: {
    marginLeft: 'auto',
  },
  charCountText: {
    fontSize: 13,
    color: COLORS.gray[500],
  },
});
```

---

## ✅ 验证标准

完成后需确保：

1. **打开发布页面**
   - ✅ 光标自动聚焦到输入框
   - ✅ 无需任何选择即可开始输入
   - ✅ 占位符文字友好提示

2. **输入内容**
   - ✅ 输入框支持多行自动扩展
   - ✅ 实时显示字符计数
   - ✅ 达到10字符后发布按钮激活

3. **添加媒体**
   - ✅ 点击图片图标可选择图片（最多9张）
   - ✅ 点击视频图标可选择视频（最多1个）
   - ✅ 预览区域显示已选媒体
   - ✅ 可删除已选媒体

4. **发布**
   - ✅ 仅检查内容长度（≥10字符）
   - ✅ 分区和标签为可选
   - ✅ 发布成功后跳转或返回
   - ✅ 发布失败有错误提示

5. **用户体验**
   - ✅ 整体流程不超过3步（输入→添加媒体→发布）
   - ✅ 无强制必填项（除内容本身）
   - ✅ 加载/发布时有明确状态提示

---

## 🚀 额外建议

### 性能优化
- 使用`TextInput`的`autoGrow`属性自动调整高度
- 图片上传使用压缩和进度条
- 草稿保存使用防抖（debounce）

### 用户体验
- 添加"取消"时的二次确认（如果已输入内容）
- 支持Markdown快捷语法（可选）
- 发布成功后清空表单并展示成功动画

### 可访问性
- 确保所有按钮有适当的`accessibilityLabel`
- 支持键盘快捷键（如Cmd+Enter发布）

---

## 📌 总结

**核心改变**：
- 从"选择类型→填写内容→发布"变为"直接输入→发布"
- 减少必填项，提升发布效率
- 保持功能完整性，优化用户体验

**预期效果**：
- 发布时间从30秒缩短到10秒以内
- 用户操作步骤从5步减少到2步
- 更符合现代社交媒体使用习惯

请按照以上要求重构`app/community/create.jsx`文件，创建一个简洁、高效、类似Twitter的发布体验！