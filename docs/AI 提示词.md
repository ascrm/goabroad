根据你的需求，我来帮你转化为清晰的 AI 提示词：

---

## AI 开发任务提示词

### 任务概述
需要重构 `app/community/article/create.jsx` 中的图片上传和展示逻辑，将图片从外部预览区移入富文本编辑器内部，实现图文混排效果。

### 当前实现分析

**现状问题：**
1. 点击工具栏的照片图标后，图片仅保存在本地 state（`images` 数组）
2. 图片在富文本编辑器外部独立展示（第 426-445 行的预览区域）
3. 图片与正文内容分离，无法实现图文混排
4. 用户无法控制图片在文章中的插入位置

### 核心需求

#### 需求 1：即时上传逻辑
- **触发时机**：用户点击工具栏的照片图标，并从相册/相机选择完图片后
- **上传流程**：
  1. 立即调用文件上传 API 将图片上传到服务器
  2. 显示上传进度指示器（加载状态）
  3. 上传成功后获取图片的远程 URL
  4. 将远程 URL 插入到富文本编辑器中

#### 需求 2：富文本内嵌展示
- **展示位置**：图片应插入到富文本编辑器的当前光标位置
- **展示效果**：
  1. 图片作为 HTML `<img>` 标签嵌入到编辑器内容中
  2. 图片与文字可以混排（用户可在图片前后输入文字）
  3. 图片在编辑器中可见可编辑（可删除、可调整位置）
  4. 最终发布时，图片 URL 包含在正文的 HTML 内容中

### 技术实现要点

#### 1. 文件上传 API 集成
- 检查项目中是否已有文件上传 API（查看 `src/services/api/modules/` 目录）
- 如果没有，需要创建文件上传服务，参考 API 文档 `docs/API接口文档/文件模块.md`
- 上传方法应支持 FormData 格式，返回图片的远程 URL

#### 2. 富文本编辑器能力扩展
- 查看 `RichTextEditor` 组件（`src/components/community/create/RichTextEditor.jsx`）是否已有插入图片的方法
- 如果没有，需要添加 `insertImage(url)` 方法，调用底层 RichEditor 的插入图片功能
- 该方法应该将图片插入到当前光标位置

#### 3. UI/UX 优化
- **上传中状态**：显示加载指示器或进度条，禁用重复上传
- **错误处理**：上传失败时显示错误提示，允许用户重试
- **多图片支持**：支持一次选择多张图片，依次上传并插入
- **图片限制**：保持原有的 9 张图片限制（可选，根据产品需求调整）

#### 4. 需要移除的代码
- 移除独立的图片预览区域（第 426-445 行）
- 移除 `images` state 数组（第 49 行），因为图片已嵌入 HTML 内容
- 移除图片相关的草稿保存逻辑（或调整为从 HTML 中提取图片）
- 更新工具栏右侧的图片计数逻辑（或直接移除，因为图片已在内容中）

#### 5. 需要修改的函数
- **`handlePickImages`**：改为上传图片并插入编辑器
- **`handleTakePhoto`**：改为上传图片并插入编辑器
- **`handlePublish`**：移除 `mediaUrls` 字段，图片 URL 已包含在 `content` HTML 中

### 预期最终效果

**用户操作流程：**
1. 用户在编辑器中输入文字："这是第一段内容"
2. 用户将光标移到文字末尾，点击工具栏的照片图标
3. 用户选择 2 张图片
4. 显示"上传中..."指示器
5. 第 1 张图片上传完成，自动插入到光标位置
6. 第 2 张图片上传完成，自动插入到第 1 张图片后面
7. 用户继续输入文字："这是第二段内容"
8. 最终效果：文字-图片-图片-文字，图文混排

**发布时的数据结构：**
```javascript
{
  contentType: 'GUIDE',
  title: '标题',
  content: '<p>这是第一段内容</p><img src="https://cdn.example.com/image1.jpg"><img src="https://cdn.example.com/image2.jpg"><p>这是第二段内容</p>',
  // 不再需要单独的 mediaUrls 字段
}
```

### 注意事项
1. 确保上传过程中用户体验流畅，避免阻塞编辑
2. 处理网络错误和上传失败的情况
3. 考虑图片压缩（可能已在 ImagePicker 配置中设置）
4. 保持代码的可维护性和可读性
5. 测试多图片上传、大图片上传等边界情况

---

这个提示词涵盖了需求背景、技术要点、实现细节和预期效果，应该能够指导 AI 完成完整的功能开发。